(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37f6b032"],{2422:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"crumbs"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[s("i",{staticClass:"el-icon-lx-calendar"}),e._v(" 商品")]),s("el-breadcrumb-item",[e._v("添加商品")])],1)],1),s("div",{staticClass:"container"},[s("div",{staticClass:"form-box"},[s("el-form",{ref:"form",attrs:{model:e.detailForm,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"商品图片"}},[s("el-upload",{staticClass:"upload-demo",attrs:{action:e.IP+"system/file/upload",multiple:!1,"on-success":e.handleSuccess,"on-error":e.handleError,"on-remove":e.handleRemove,"file-list":e.imgList,limit:e.min,"list-type":"picture"}},[s("el-button",{attrs:{size:"small",type:"primary",disabled:e.imgList.length>=1}},[e._v("点击上传")]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500k")])],1)],1),s("el-form-item",{attrs:{label:"商品名称"}},[s("el-input",{staticStyle:{width:"200px"},model:{value:e.detailForm.productName,callback:function(t){e.$set(e.detailForm,"productName",t)},expression:"detailForm.productName"}})],1),s("el-form-item",{attrs:{label:"商品价格"}},[s("el-input",{staticStyle:{width:"200px"},on:{input:e.onMoneyBlur},model:{value:e.detailForm.price,callback:function(t){e.$set(e.detailForm,"price",t)},expression:"detailForm.price"}})],1),s("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"商品描述"}},[s("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:e.detailForm.descript,callback:function(t){e.$set(e.detailForm,"descript",t)},expression:"detailForm.descript"}})],1)],1),s("el-form",{ref:"forms",attrs:{model:e.detailForm,"label-width":"80px",inline:!0}},[s("div",[e._v("基本属性："),s("p",{staticClass:"m-tips"},[e._v("Tips:基本属性的值应为键值对形式，例：color:#dddddd; ")])]),e._l(e.obj,function(t,i){return s("el-form-item",{key:i,staticStyle:{"margin-left":"80px"}},[s("el-input",{staticStyle:{width:"300px"},model:{value:t.key,callback:function(s){e.$set(t,"key",s)},expression:"item.key"}}),s("el-button",{staticClass:"m-icon",attrs:{type:"success",icon:"el-icon-plus",circle:"",size:"mini"},on:{click:e.addBase}}),s("el-button",{staticClass:"m-icon",attrs:{type:"danger",icon:"el-icon-minus",circle:"",size:"mini"},on:{click:function(t){return e.removeBase(i)}}})],1)}),s("div",{staticClass:"m-btn",staticStyle:{width:"100%","margin-left":"0"}}),s("div",[e._v("商品分类：")]),s("el-cascader",{staticStyle:{width:"400px","margin-top":"10px","margin-left":"80px"},attrs:{options:e.labelList},on:{change:e.cascaderChange},model:{value:e.selectedOptions3,callback:function(t){e.selectedOptions3=t},expression:"selectedOptions3"}}),s("div",{staticClass:"m-box"},[e._v("商品标签：")]),s("el-select",{staticStyle:{"margin-left":"80px",width:"400px"},attrs:{multiple:"",placeholder:"请选择"},on:{change:function(t){return e.labelChange()}},model:{value:e.value7,callback:function(t){e.value7=t},expression:"value7"}},e._l(e.options3,function(t){return s("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)}),1),s("div",{staticClass:"m-box"},[e._v("商品规格：")]),s("el-collapse",{staticStyle:{"margin-left":"80px"},attrs:{accordion:""},on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[e._l(e.propList,function(t,i){return s("el-collapse-item",{key:i,attrs:{title:"规格"+(i+1),name:i+1}},[s("div",{staticClass:"m-span"},[e._v("规格")]),e._l(t.options,function(t,a){return s("div",{key:a,staticClass:"m-sp"},[s("span",[e._v(e._s(t.keyName))]),s("el-select",{attrs:{placeholder:"请选择"},on:{change:function(s){return e.asdsa(t.spec,t)}},model:{value:e.propList[i].options[a].spec,callback:function(t){e.$set(e.propList[i].options[a],"spec",t)},expression:"propList[index].options[inde].spec"}},e._l(t.valueList,function(e){return s("el-option",{key:e.valueId,attrs:{label:e.propValue,value:e.propValue}})}),1)],1)}),s("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"商品价格"}},[s("el-input",{staticStyle:{width:"200px"},on:{input:function(t){return e.propPrice(i)}},model:{value:t.price,callback:function(s){e.$set(t,"price",s)},expression:"item.price"}},[s("template",{slot:"append"},[e._v("$")])],2)],1),s("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"商品库存"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{type:"number"},model:{value:t.stock,callback:function(s){e.$set(t,"stock",e._n(s))},expression:"item.stock"}})],1),s("div",[s("span",{staticClass:"m-span"},[e._v("商品图片")]),s("p",{staticClass:"m-tips"},[e._v("tips:第一张图片为主图，有且仅有一张，后面为商品幅图，可为多张，最少一张")])]),s("el-upload",{staticClass:"m-up",attrs:{action:e.IP+"system/file/upload","list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemoves,"on-success":e.baseHandleSuccess,"on-error":e.baseHandleError,"file-list":t.productImgList}},[s("i",{staticClass:"el-icon-plus"})]),s("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})]),s("div",{staticClass:"m-add",on:{click:function(t){return e.removeColl(i)}}},[e._v("移除")])],2)}),s("div",{staticClass:"m-add",on:{click:e.addColl}},[e._v("添加")])],2)],2),s("div",{staticClass:"m-sure"},[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(" 确认修改")])],1)],1)])])},a=[],o=(s("f91a"),s("612f"),s("3a23"),s("f46d")),r=s.n(o),l=s("d4fd"),c=s("2de9"),n={name:"baseform",data:function(){var e;return e={IP:c["a"].IP,IMGURL:c["a"].IMGURL,productId:"",imgList:[],tableData:{},min:1,obj:[{key:""}],labelList:[],propList:[{options:[],productImgList:[],productImages:[]}],activeNames:"",dialogImageUrl:"",dialogVisible:!1,options:[],form:{name:"",region:"",date1:"",date2:"",delivery:!0,type:[],resource:"是",newShop:"是",desc:"",options:[]}},Object(l["a"])(e,"options",[]),Object(l["a"])(e,"selectedOptions3",[]),Object(l["a"])(e,"selectedOptions",[]),Object(l["a"])(e,"options3",[]),Object(l["a"])(e,"value7",""),Object(l["a"])(e,"bcb",0),Object(l["a"])(e,"specList",[]),Object(l["a"])(e,"specAllList",[]),Object(l["a"])(e,"detailForm",{price:0,productName:"",descript:""}),e},watch:{},created:function(){this.getLabel(),this.getProp(),this.getClassification()},methods:{asdsa:function(e,t){console.log(e,t),this.$forceUpdate()},propPrice:function(e){var t=this;setTimeout(function(){if(!/^[0-9]+(\.?(?=[0-9])[0-9]{0,2})?$/.test(t.propList[e].price))return t.$message.error("请输入正确的价格"),void(t.propList[e].price=0)},1e3)},onMoneyBlur:function(){var e=this;setTimeout(function(){if(!/^[0-9]+(\.?(?=[0-9])[0-9]{0,2})?$/.test(e.detailForm.price))return e.$message.error("请输入正确的价格"),void(e.detailForm.price=0)},1e3)},statusChange:function(){console.log(this.tableData.publishStatus)},isNewChange:function(){console.log(this.tableData.isNew)},addBase:function(){this.obj.push({key:""}),console.log(this.obj)},removeBase:function(e){this.obj.length<=1?this.$message.error("基本属性不可为空"):(this.obj.splice(e,1),console.log(this.obj))},cascaderChange:function(){console.log(this.selectedOptions3)},removeCascader:function(){},addColl:function(){this.propList.push({options:JSON.parse(r()(this.specAllList)),productImgList:[],productImages:[]}),console.log(this.propList)},removeColl:function(e){this.propList.splice(e,1)},handleSuccess:function(e,t,s){console.log(e,t,s),this.$message.success("图片上传成功"),console.log(e.data),this.detailForm.productImage=e.data,this.imgList[0]={name:t.name,url:t.url}},handleRemove:function(e){this.imgList.forEach(function(t,s,i){t.uid===e.uid&&i.splice(s,1)}),this.detailForm.url=""},handleError:function(e,t,s){this.$message.error("图片上传失败")},handleRemoves:function(e,t){var s=this;this.propList[this.activeNames-1].productImgList.forEach(function(t,i,a){t.uid===e.uid&&(a.splice(i,1),s.propList[s.activeNames-1].productImages.splice(i,1))}),console.log(this.propList)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},baseHandleSuccess:function(e,t,s){this.$message.success("图片上传成功"),this.propList[this.activeNames-1].productImgList.push({url:t.url,uid:t.uid}),this.propList[this.activeNames-1].productImages.push({imgUrl:e.data}),console.log(this.propList)},baseHandleError:function(e,t,s){this.$message.error("图片上传失败")},handleChange:function(){console.log(this.activeNames)},getClassification:function(){var e=this;this.$axios.get(c["a"].ALLCATEGORYLIST,{headers:{token:sessionStorage.getItem("token")}}).then(function(t){if("-30"==t.data.code&&(e.$message.error("登录超时，请重新登录！"),setTimeout(function(){e.$router.push("/login")},3e3)),0==t.data.code){var s=JSON.parse(r()(t.data.data).replace(/categoryName/g,"label").replace(/categoryId/g,"value").replace(/cateGoryList/g,"children"));e.labelList=s}})},getLabel:function(){var e=this;this.$axios.get(c["a"].ALLLABEL,{headers:{token:sessionStorage.getItem("token")}}).then(function(t){if("-30"==t.data.code&&(e.$message.error("登录超时，请重新登录！"),setTimeout(function(){e.$router.push("/login")},3e3)),0==t.data.code){var s=JSON.parse(r()(t.data.data).replace(/typeName/g,"label").replace(/typeId|valueId/g,"value").replace(/paramValues/g,"options").replace(/paramValue/g,"label"));console.log(s),e.options3=s}})},getProp:function(){var e=this;this.$axios.get(c["a"].PROPLIST,{headers:{token:sessionStorage.getItem("token")}}).then(function(t){"-30"==t.data.code&&(e.$message.error("登录超时，请重新登录！"),setTimeout(function(){e.$router.push("/login")},3e3)),0==t.data.code&&(e.specAllList=t.data.data,e.specAllList.map(function(e,t){e.spec=""}),e.propList.map(function(t,s){t.options=JSON.parse(r()(e.specAllList)),t.options.map(function(e){for(var s in t.productSpecsJson)e.keyName==s&&(e.spec=t.productSpecsJson[s])})}),console.log(e.propList))})},labelChange:function(){console.log(this.value7)},onSubmit:function(){var e=this;this.detailForm.baseProp="",console.log(this.obj),this.obj.map(function(t){e.detailForm.baseProp+=t.key+'","'}),console.log(this.detailForm.baseProp),this.detailForm.baseProp='{"'+this.detailForm.baseProp.substring(0,this.detailForm.baseProp.length-2)+"}",this.detailForm.baseProp=this.detailForm.baseProp.replace(/:/g,'":"'),this.detailForm.categoryId=this.selectedOptions3[1],this.detailForm.paramIdList=this.value7,this.propList.map(function(e){e.productSpecs="",e.options.map(function(t){e.productSpecs+="'".concat(t.keyName,"':'").concat(t.spec,"',")}),e.productSpecs="{"+e.productSpecs.substring(0,e.productSpecs.length-1)+"}",console.log(e.productSpecs)}),this.propList.map(function(e){e.productImageDtoList=JSON.parse(r()(e.productImages).replace(/imgUrl/g,"imageUrl"))}),this.detailForm.productSpecDtoList=this.propList,this.$axios.post(c["a"].ADDSHOP,this.detailForm,{headers:{token:sessionStorage.getItem("token")}}).then(function(t){-2==t.data.code?e.$message.error(t.data.daata):0==t.data.code?(e.$message.success("修改成功"),e.$router.push({path:"./shop"})):e.$message.error("请确认所有数据填写正确")})}}},p=n,d=(s("fd64"),s("17cc")),u=Object(d["a"])(p,i,a,!1,null,"afff146c",null);t["default"]=u.exports},2675:function(e,t,s){var i=s("471d");i(i.S+i.F*!s("690a"),"Object",{defineProperty:s("4cf4").f})},"2de9":function(e,t,s){"use strict";var i="http://114.115.211.170:8088/";t["a"]={IP:i,IMGURL:i+"system/file/showPicture?imageId=",LOGIN:i+"system/user/login",SHOP:i+"system/product/getProductList",SHOPDETAIL:i+"system/product/getProductListById",DELSHOP:i+"system/product/delProduct",ALLDELSHOP:i+"system/product/delProduct",DISCOUNT:i+"system/product/setProductDiscounts",DELSHOPLABAL:i+"system/product/delProductParam",DELSHOPPROP:i+"system/product/delProductProp",ADDSHOP:i+"system/product/addProduct",ADDSHOPLABAL:i+"system/product/addProductParam",ADDSHOPPROP:i+"system/product/addProductProp",EDOTSHOPPROP:i+"system/product/updProductProp",SHELVESSHOP:i+"system/product/shelvesProduct",THESHELVESSHOP:i+"system/product/theShelvesProduct",NEWSHOP:i+"system/product/setOrCancelNewProduct",PROPLIST:i+"system/shopProp/queryPropList",UPSHOP:i+"system/product/updProduct",SHUFFLING:i+"system/slides/getSlidesList",FREEZESHUFFLING:i+"system/slides/updSlides",DELSHUFFLING:i+"system/slides/delSlides",DELALLSHUFFLING:i+"system/slides/batchDeleteSlides",ADDSHUFFLING:i+"system/slides/addSlides",ALLCATEGORYLIST:i+"system/category/queryCateGoryList",CATEGORYLIST:i+"system/category/getCateGoryList",TWOCATEGORYLIST:i+"system/category/getCateGoryListByTwoLevel",ADDCATEGORY:i+"system/category/addCategory",UPCATEGORY:i+"system/category/updCategory",DELCATEGORY:i+"system/category/delCateGory",DELALLCATEGORY:i+"system/category/batchDelCateGory",ALLLABEL:i+"system/param/queryShopParamList",LABEL:i+"system/param/getShopParamKeyList",TLABEL:i+"system/param/getShopParamValueList",ADDLABEL:i+"system/param/addShopParamType",ADDTLABEL:i+"system/param/addShopParamValue",DELLABEL:i+"system/param/delShopParamType",DELTLABEL:i+"system/param/delShopParamValue",EDITLABEL:i+"system/param/updShopParamType",EDTITLABEL:i+"system/param/updShopParamValue",DELALLTABEL:i+"system/param/batchDelShopParamType",DELALLTTABEL:i+"system/param/batchDelShopParamValue",SPECKEY:i+"system/shopProp/getListKey",SPECVALUE:i+"system/shopProp/getListValue",ADDSPECKEY:i+"system/shopProp/addPropKey",ADDSPECVALUE:i+"system/shopProp/addPropValue",UPSPECKEY:i+"system/shopProp/updPropKey",UPSPECVALUE:i+"system/shopProp/updPropValue",DELSPECKEY:i+"system/shopProp/delPropKey",DELSPECVALUE:i+"system/shopProp/delPropValue",DELALLSPECKEY:i+"system/shopProp/batchDelPropKey",DELALLSPECVALUE:i+"system/shopProp/batchDelPropValue",DISTRIBUTION:i+"system/distribution/getStoreDistribution",ADDDISTRIBUTION:i+"system/distribution/addDistribution",UPDISTRIBUTION:i+"system/distribution/updateDistribution",DELDISTRIBUTION:i+"system/distribution/delDistribution",DELALLDISTRIBUTION:i+"system/distribution/batchDelDistribution",SERVICE:i+"system/support/getCustomerService",UPSERVICE:i+"system/support/updateCustomerService",HELP:i+"system/help/getSysHelpList",ADDHELP:i+"system/help/addHelp",UPHELP:i+"system/help/updateSysHelpList",DELHELP:i+"system/help/deleteSysHelpList",DELALLHELP:i+"system/help/batchDeleteSysHelpList",FEEDBACK:i+"system/support/getUsersMessageList",DEALWITHFEEDBACK:i+"system/support/dealWithMessage",DEALWITHALLFEEDBACK:i+"system/support/batchDealWithMessage",TREND:i+"system/trend/getTrendList",TRENDSHOP:i+"system/trend/getTrendProductList",ADDTRENDSHOP:i+"system/trend/addTrendProduct",ADDTREND:i+"system/trend/addTrend",ADDALLTRENDSHOP:i+"system/trend/batchAddTrendProduct",DELALLTREND:i+"system/trend/batchDelTrend",DELALLTRENDPRODUCT:i+"system/trend/batchDelTrendProduct",DELTREND:i+"system/trend/delTrendProduct",DELTRENDSHOP:i+"system/trend/delTrendProduct",UPTREND:i+"system/trend/updTrend",TRENDSHOPS:i+"system/product/getTrendProductList",POP:i+"system/advertising/getAdvertisingList",UPPOP:i+"system/advertising/updateAdvertising",SEARCHPOPSHOP:i+"system/product/getAdvertisingProductList",POPSHOP:i+"system/advertising/getAdvertisingProductList",POPSHOPS:i+"system/product/getAdvertisingProductList",ADDALLPOPSHOP:i+"system/advertising/batchAddAdvertisingProduct",DELPOPSHOP:i+"system/advertising/delAdvertisingProduct",DELALLPOPSHOP:i+"system/advertising/batchDelAdvertisingProduct"}},"431d":function(e,t,s){e.exports=s("e432")},"5ab7":function(e,t,s){var i=s("836e"),a=i.JSON||(i.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},d4fd:function(e,t,s){"use strict";s.d(t,"a",function(){return o});var i=s("431d"),a=s.n(i);function o(e,t,s){return t in e?a()(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}},e432:function(e,t,s){s("2675");var i=s("836e").Object;e.exports=function(e,t,s){return i.defineProperty(e,t,s)}},f46d:function(e,t,s){e.exports=s("5ab7")},f744:function(e,t,s){},fd64:function(e,t,s){"use strict";var i=s("f744"),a=s.n(i);a.a}}]);