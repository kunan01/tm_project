(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6588b954"],{2675:function(e,t,s){var a=s("471d");a(a.S+a.F*!s("690a"),"Object",{defineProperty:s("4cf4").f})},"2de9":function(e,t,s){"use strict";var a="http://114.115.211.170:8088/";t["a"]={IP:a,IMGURL:a+"system/file/showPicture?imageId=",LOGIN:a+"system/user/login",SHOP:a+"system/product/getProductList",SHOPDETAIL:a+"system/product/getProductListById",DELSHOP:a+"system/product/delProduct",ALLDELSHOP:a+"system/product/delProduct",DISCOUNT:a+"system/product/setProductDiscounts",DELSHOPLABAL:a+"system/product/delProductParam",DELSHOPPROP:a+"system/product/delProductProp",ADDSHOP:a+"system/product/addProduct",ADDSHOPLABAL:a+"system/product/addProductParam",ADDSHOPPROP:a+"system/product/addProductProp",EDOTSHOPPROP:a+"system/product/updProductProp",SHELVESSHOP:a+"system/product/shelvesProduct",THESHELVESSHOP:a+"system/product/theShelvesProduct",NEWSHOP:a+"system/product/setOrCancelNewProduct",PROPLIST:a+"system/shopProp/queryPropList",UPSHOP:a+"system/product/updProduct",SHUFFLING:a+"system/slides/getSlidesList",FREEZESHUFFLING:a+"system/slides/updSlides",DELSHUFFLING:a+"system/slides/delSlides",DELALLSHUFFLING:a+"system/slides/batchDeleteSlides",ADDSHUFFLING:a+"system/slides/addSlides",ALLCATEGORYLIST:a+"system/category/queryCateGoryList",CATEGORYLIST:a+"system/category/getCateGoryList",TWOCATEGORYLIST:a+"system/category/getCateGoryListByTwoLevel",ADDCATEGORY:a+"system/category/addCategory",UPCATEGORY:a+"system/category/updCategory",DELCATEGORY:a+"system/category/delCateGory",DELALLCATEGORY:a+"system/category/batchDelCateGory",ALLLABEL:a+"system/param/queryShopParamList",LABEL:a+"system/param/getShopParamKeyList",TLABEL:a+"system/param/getShopParamValueList",ADDLABEL:a+"system/param/addShopParamType",ADDTLABEL:a+"system/param/addShopParamValue",DELLABEL:a+"system/param/delShopParamType",DELTLABEL:a+"system/param/delShopParamValue",EDITLABEL:a+"system/param/updShopParamType",EDTITLABEL:a+"system/param/updShopParamValue",DELALLTABEL:a+"system/param/batchDelShopParamType",DELALLTTABEL:a+"system/param/batchDelShopParamValue",SPECKEY:a+"system/shopProp/getListKey",SPECVALUE:a+"system/shopProp/getListValue",ADDSPECKEY:a+"system/shopProp/addPropKey",ADDSPECVALUE:a+"system/shopProp/addPropValue",UPSPECKEY:a+"system/shopProp/updPropKey",UPSPECVALUE:a+"system/shopProp/updPropValue",DELSPECKEY:a+"system/shopProp/delPropKey",DELSPECVALUE:a+"system/shopProp/delPropValue",DELALLSPECKEY:a+"system/shopProp/batchDelPropKey",DELALLSPECVALUE:a+"system/shopProp/batchDelPropValue",DISTRIBUTION:a+"system/distribution/getStoreDistribution",ADDDISTRIBUTION:a+"system/distribution/addDistribution",UPDISTRIBUTION:a+"system/distribution/updateDistribution",DELDISTRIBUTION:a+"system/distribution/delDistribution",DELALLDISTRIBUTION:a+"system/distribution/batchDelDistribution",SERVICE:a+"system/support/getCustomerService",UPSERVICE:a+"system/support/updateCustomerService",HELP:a+"system/help/getSysHelpList",ADDHELP:a+"system/help/addHelp",UPHELP:a+"system/help/updateSysHelpList",DELHELP:a+"system/help/deleteSysHelpList",DELALLHELP:a+"system/help/batchDeleteSysHelpList",FEEDBACK:a+"system/support/getUsersMessageList",DEALWITHFEEDBACK:a+"system/support/dealWithMessage",DEALWITHALLFEEDBACK:a+"system/support/batchDealWithMessage",TREND:a+"system/trend/getTrendList",TRENDSHOP:a+"system/trend/getTrendProductList",ADDTRENDSHOP:a+"system/trend/addTrendProduct",ADDTREND:a+"system/trend/addTrend",ADDALLTRENDSHOP:a+"system/trend/batchAddTrendProduct",DELALLTREND:a+"system/trend/batchDelTrend",DELALLTRENDPRODUCT:a+"system/trend/batchDelTrendProduct",DELTREND:a+"system/trend/delTrendProduct",DELTRENDSHOP:a+"system/trend/delTrendProduct",UPTREND:a+"system/trend/updTrend",TRENDSHOPS:a+"system/product/getTrendProductList",POP:a+"system/advertising/getAdvertisingList",UPPOP:a+"system/advertising/updateAdvertising",SEARCHPOPSHOP:a+"system/product/getAdvertisingProductList",POPSHOP:a+"system/advertising/getAdvertisingProductList",POPSHOPS:a+"system/product/getAdvertisingProductList",ADDALLPOPSHOP:a+"system/advertising/batchAddAdvertisingProduct",DELPOPSHOP:a+"system/advertising/delAdvertisingProduct",DELALLPOPSHOP:a+"system/advertising/batchDelAdvertisingProduct"}},"431d":function(e,t,s){e.exports=s("e432")},"5ab7":function(e,t,s){var a=s("836e"),i=a.JSON||(a.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},6782:function(e,t,s){"use strict";var a=s("9065"),i=s.n(a);i.a},9065:function(e,t,s){},bc27:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"crumbs"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[s("i",{staticClass:"el-icon-lx-calendar"}),e._v(" 商品")]),s("el-breadcrumb-item",[e._v("商品详情")])],1)],1),s("div",{staticClass:"container"},[s("div",{staticClass:"form-box"},[s("el-form",{ref:"form",attrs:{model:e.tableData,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"商品图片"}},[s("el-upload",{staticClass:"upload-demo",attrs:{action:e.IP+"system/file/upload",multiple:!1,"on-success":e.handleSuccess,"on-error":e.handleError,"on-remove":e.handleRemove,"file-list":e.imgList,limit:e.min,"list-type":"picture"}},[s("el-button",{attrs:{size:"small",type:"primary",disabled:e.imgList.length>=1}},[e._v("点击上传")]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500k")])],1)],1),s("el-form-item",{attrs:{label:"商品名称"}},[s("el-input",{staticStyle:{width:"200px"},model:{value:e.tableData.productName,callback:function(t){e.$set(e.tableData,"productName",t)},expression:"tableData.productName"}})],1),s("el-form-item",{attrs:{label:"商品价格"}},[s("el-input",{staticStyle:{width:"200px"},on:{input:e.onMoneyBlur},model:{value:e.tableData.price,callback:function(t){e.$set(e.tableData,"price",t)},expression:"tableData.price"}})],1),s("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"商品描述"}},[s("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:e.tableData.descript,callback:function(t){e.$set(e.tableData,"descript",t)},expression:"tableData.descript"}})],1)],1),s("el-form",{ref:"forms",attrs:{model:e.tableData,"label-width":"80px",inline:!0}},[s("div",[e._v("基本属性："),s("p",{staticClass:"m-tips"},[e._v("Tips:基本属性的值应为键值对形式，例：color:#dddddd; ")])]),e._l(e.obj,function(t,a){return s("el-form-item",{key:a,staticStyle:{"margin-left":"80px"}},[s("el-input",{staticStyle:{width:"300px"},model:{value:t.key,callback:function(s){e.$set(t,"key",s)},expression:"item.key"}}),s("el-button",{staticClass:"m-icon",attrs:{type:"success",icon:"el-icon-plus",circle:"",size:"mini"},on:{click:e.addBase}}),s("el-button",{staticClass:"m-icon",attrs:{type:"danger",icon:"el-icon-minus",circle:"",size:"mini"},on:{click:function(t){return e.removeBase(a)}}})],1)}),s("div",{staticClass:"m-btn",staticStyle:{width:"100%","margin-left":"0"}}),s("div",[e._v("商品分类：")]),s("el-cascader",{staticStyle:{width:"400px","margin-top":"10px","margin-left":"80px"},attrs:{options:e.labelList},on:{change:e.cascaderChange},model:{value:e.selectedOptions3,callback:function(t){e.selectedOptions3=t},expression:"selectedOptions3"}}),s("div",{staticClass:"m-box"},[e._v("商品标签：")]),s("el-select",{staticStyle:{"margin-left":"80px",width:"400px"},attrs:{multiple:"",placeholder:"请选择"},on:{change:function(t){return e.labelChange()}},model:{value:e.value7,callback:function(t){e.value7=t},expression:"value7"}},e._l(e.options3,function(t){return s("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)}),1),s("div",{staticClass:"m-box"},[e._v("商品规格：")]),s("el-collapse",{staticStyle:{"margin-left":"80px"},attrs:{accordion:""},on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[e._l(e.propList,function(t,a){return s("el-collapse-item",{key:a,attrs:{title:"规格"+(a+1),name:a+1}},[s("div",{staticClass:"m-span"},[e._v("规格")]),e._l(t.options,function(t,i){return s("div",{key:i,staticClass:"m-sp"},[s("span",[e._v(e._s(t.keyName))]),s("el-select",{attrs:{placeholder:"请选择"},on:{change:function(s){return e.asdsa(t.spec,t)}},model:{value:e.propList[a].options[i].spec,callback:function(t){e.$set(e.propList[a].options[i],"spec",t)},expression:"propList[index].options[inde].spec"}},e._l(t.valueList,function(e){return s("el-option",{key:e.valueId,attrs:{label:e.propValue,value:e.propValue}})}),1)],1)}),s("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"商品价格"}},[s("el-input",{staticStyle:{width:"200px"},on:{input:function(t){return e.propPrice(a)}},model:{value:t.price,callback:function(s){e.$set(t,"price",s)},expression:"item.price"}},[s("template",{slot:"append"},[e._v("$")])],2)],1),s("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"商品库存"}},[s("el-input",{staticStyle:{width:"200px"},model:{value:t.stock,callback:function(s){e.$set(t,"stock",e._n(s))},expression:"item.stock"}})],1),s("div",[s("span",{staticClass:"m-span"},[e._v("商品图片")]),s("p",{staticClass:"m-tips"},[e._v("tips:第一张图片为主图，有且仅有一张，后面为商品幅图，可为多张，最少一张")])]),s("el-upload",{staticClass:"m-up",attrs:{action:e.IP+"system/file/upload","list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemoves,"on-success":e.baseHandleSuccess,"on-error":e.baseHandleError,"file-list":t.productImgList}},[s("i",{staticClass:"el-icon-plus"})]),s("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})]),s("div",{staticClass:"m-add",on:{click:function(t){return e.removeColl(a)}}},[e._v("移除")])],2)}),s("div",{staticClass:"m-add",on:{click:e.addColl}},[e._v("添加")])],2)],2),s("div",{staticClass:"m-sure"},[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(" 确认修改")])],1)],1)])])},i=[],o=(s("f91a"),s("b06f"),s("612f"),s("3a23"),s("f46d")),r=s.n(o),l=s("d4fd"),n=s("2de9"),c={name:"baseform",data:function(){var e;return e={IP:n["a"].IP,IMGURL:n["a"].IMGURL,productId:"",imgList:[],tableData:{},min:1,obj:[{key:""}],labelList:[],propList:[{}],activeNames:"",dialogImageUrl:"",dialogVisible:!1,options:[{value:"guangdong",label:"广东省",children:[{value:"guangzhou",label:"广州市",children:[{value:"tianhe",label:"天河区"},{value:"haizhu",label:"海珠区"}]},{value:"dongguan",label:"东莞市",children:[{value:"changan",label:"长安镇"},{value:"humen",label:"虎门镇"}]}]},{value:"hunan",label:"湖南省",children:[{value:"changsha",label:"长沙市",children:[{value:"yuelu",label:"岳麓区"}]}]}],form:{name:"",region:"",date1:"",date2:"",delivery:!0,type:["步步高"],resource:"是",newShop:"是",desc:"",options:[]}},Object(l["a"])(e,"options",[]),Object(l["a"])(e,"selectedOptions3",[]),Object(l["a"])(e,"selectedOptions",[]),Object(l["a"])(e,"options3",[]),Object(l["a"])(e,"value7",""),Object(l["a"])(e,"bcb",0),Object(l["a"])(e,"specList",[]),Object(l["a"])(e,"specAllList",[]),Object(l["a"])(e,"detailForm",{}),e},watch:{},created:function(){this.productId=this.$route.query.id,this.getData()},methods:{asdsa:function(e,t){console.log(e,t),this.$forceUpdate()},propPrice:function(e){var t=this;setTimeout(function(){if(!/^[0-9]+(\.?(?=[0-9])[0-9]{0,2})?$/.test(t.propList[e].price))return t.$message.error("请输入正确的价格"),void(t.propList[e].price=0)},1e3)},onMoneyBlur:function(){var e=this;setTimeout(function(){if(!/^[0-9]+(\.?(?=[0-9])[0-9]{0,2})?$/.test(e.tableData.price))return e.$message.error("请输入正确的价格"),void(e.tableData.price=0)},1e3)},statusChange:function(){console.log(this.tableData.publishStatus)},isNewChange:function(){console.log(this.tableData.isNew)},addBase:function(){this.obj.push({key:""}),console.log(this.obj)},removeBase:function(e){this.obj.length<=1?this.$message.error("基本属性不可为空"):(this.obj.splice(e,1),console.log(this.obj))},cascaderChange:function(){console.log(this.selectedOptions3)},removeCascader:function(){},addColl:function(){this.propList.push({options:JSON.parse(r()(this.specAllList)),productImgList:[],productImages:[]}),console.log(this.propList)},removeColl:function(e){this.propList.splice(e,1)},handleSuccess:function(e,t,s){console.log(e,t,s),this.$message.success("图片上传成功"),console.log(e.data),this.detailForm.url=e.data,this.imgList[0]={name:t.name,url:t.url}},handleRemove:function(e){this.imgList.forEach(function(t,s,a){t.uid===e.uid&&a.splice(s,1)}),this.detailForm.url=""},handleError:function(e,t,s){this.$message.error("图片上传失败")},handleDelete:function(e,t){var s=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=t.slidesId;s.$axios.post(n["a"].DELSHUFFLING,{slidesId:e},{headers:{token:sessionStorage.getItem("token")}}).then(function(e){"-30"==e.data.code&&(s.$message.error("登录超时，请重新登录！"),setTimeout(function(){s.$router.push("/login")},3e3)),0==e.data.code&&(s.$message.success("删除成功！"),s.getSlideList()),console.log(e)})}).catch(function(){})},handleRemoves:function(e,t){var s=this;this.propList[this.activeNames-1].productImgList.forEach(function(t,a,i){t.uid===e.uid&&(i.splice(a,1),s.propList[s.activeNames-1].productImages.splice(a,1))}),console.log(this.propList)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},baseHandleSuccess:function(e,t,s){this.$message.success("图片上传成功"),this.propList[this.activeNames-1].productImgList.push({url:t.url,uid:t.uid}),this.propList[this.activeNames-1].productImages.push({imgUrl:e.data}),console.log(this.propList)},baseHandleError:function(e,t,s){this.$message.error("图片上传失败")},handleChange:function(){console.log(this.activeNames)},getData:function(){var e=this,t={productId:this.productId};this.$axios.get(n["a"].SHOPDETAIL,{params:t,headers:{token:sessionStorage.getItem("token")}}).then(function(t){if("-30"==t.data.code&&(e.$message.error("登录超时，请重新登录！"),setTimeout(function(){e.$router.push("/login")},3e3)),0==t.data.code){for(var s in e.tableData=t.data.data,e.obj=[],e.tableData.basePropJson)e.obj.push({key:s+":"+e.tableData.basePropJson[s]});e.selectedOptions3.push(e.tableData.cateGory.parentId),e.selectedOptions3.push(e.tableData.cateGory.categoryId),t.data.data.paramList.map(function(t){e.value7.push(Number(t.valueId))}),e.propList=e.tableData.specList,e.imgList=[].concat({url:e.IMGURL+e.tableData.productImage}),e.propList.map(function(e){e.productImgList=[]}),e.propList.map(function(t){t.productImages.map(function(s){t.productImgList.push({url:e.IMGURL+s.imageUrl})})}),e.getLabel(),e.getProp(),e.getClassification()}})},getClassification:function(){var e=this;this.$axios.get(n["a"].ALLCATEGORYLIST,{headers:{token:sessionStorage.getItem("token")}}).then(function(t){if("-30"==t.data.code&&(e.$message.error("登录超时，请重新登录！"),setTimeout(function(){e.$router.push("/login")},3e3)),0==t.data.code){var s=JSON.parse(r()(t.data.data).replace(/categoryName/g,"label").replace(/categoryId/g,"value").replace(/cateGoryList/g,"children"));e.labelList=s}})},getLabel:function(){var e=this;this.$axios.get(n["a"].ALLLABEL,{headers:{token:sessionStorage.getItem("token")}}).then(function(t){if("-30"==t.data.code&&(e.$message.error("登录超时，请重新登录！"),setTimeout(function(){e.$router.push("/login")},3e3)),0==t.data.code){var s=JSON.parse(r()(t.data.data).replace(/typeName/g,"label").replace(/typeId|valueId/g,"value").replace(/paramValues/g,"options").replace(/paramValue/g,"label"));console.log(s),e.options3=s}})},getProp:function(){var e=this;this.$axios.get(n["a"].PROPLIST,{headers:{token:sessionStorage.getItem("token")}}).then(function(t){"-30"==t.data.code&&(e.$message.error("登录超时，请重新登录！"),setTimeout(function(){e.$router.push("/login")},3e3)),0==t.data.code&&(e.specAllList=t.data.data,e.specAllList.map(function(e,t){e.spec=""}),e.propList.map(function(t,s){t.options=JSON.parse(r()(e.specAllList)),t.options.map(function(e){for(var s in t.productSpecsJson)e.keyName==s&&(e.spec=t.productSpecsJson[s])})}),console.log(e.propList))})},labelChange:function(){console.log(this.value7)},onSubmit:function(){var e=this;this.detailForm.productId=this.productId,this.detailForm.price=this.tableData.price,this.detailForm.productName=this.tableData.productName,this.detailForm.descript=this.tableData.descript,this.detailForm.baseProp="",this.obj.map(function(t){e.detailForm.baseProp+=t.key+'","'}),this.detailForm.baseProp='{"'+this.detailForm.baseProp.substring(0,this.detailForm.baseProp.length-2)+"}",this.detailForm.baseProp=this.detailForm.baseProp.replace(/:/g,'":"'),this.detailForm.categoryId=this.selectedOptions3[1],this.detailForm.paramIdList=this.value7,this.propList.map(function(e){e.productSpecs="",e.options.map(function(t){e.productSpecs+="'".concat(t.keyName,"':'").concat(t.spec,"',")}),e.productSpecs="{"+e.productSpecs.substring(0,e.productSpecs.length-1)+"}",console.log(e.productSpecs)}),this.propList.map(function(e){e.productImageDtoList=JSON.parse(r()(e.productImages).replace(/imgUrl/g,"imageUrl"))}),this.detailForm.productSpecDtoList=this.propList,console.log(this.detailForm),this.$axios.post(n["a"].UPSHOP,this.detailForm,{headers:{token:sessionStorage.getItem("token")}}).then(function(t){-2==t.data.code?e.$message.error(t.data.daata):0==t.data.code?(e.$message.success("修改成功"),e.$router.push({path:"./shop"})):e.$message.error("请确认所有数据填写正确")})}}},p=c,d=(s("6782"),s("17cc")),u=Object(d["a"])(p,a,i,!1,null,"0175a1e0",null);t["default"]=u.exports},d4fd:function(e,t,s){"use strict";s.d(t,"a",function(){return o});var a=s("431d"),i=s.n(a);function o(e,t,s){return t in e?i()(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}},e432:function(e,t,s){s("2675");var a=s("836e").Object;e.exports=function(e,t,s){return a.defineProperty(e,t,s)}},f46d:function(e,t,s){e.exports=s("5ab7")}}]);